First commit

<?php
error_log("callback start.");

// アカウント情報設定
$channel_id = "[1463689249]";
$channel_secret = "[7718fd5d55e123b637768bec6a8dd9c0]";
$mid = "[u32835129953233fc1e07bcf98d5e9243]";

// ユーザ情報取得
api_get_user_profile_request($from);

// メッセージ受信
$json_string = file_get_contents('php://input');
$json_object = json_decode($json_string);
$content = $json_object->result{0}->content;
$text = $content->text;
$from = $content->from;
$message_id = $content->id;
$content_type = $content->contentType;

// メッセージコンテンツ生成
$image_content = <<< EOM
        "contentType":2,
        "data:image/jpeg;base64,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":"{$original_content_url_for_image}",
        "data:image/jpeg;base64,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":"{$preview_image_url_for_image}"

  // 受信メッセージに応じて返すメッセージを変更
  $event_type = "138311608800106203";
  if ($text == "みりてこ") { $content = $image_content;} 
  
  EOM;
} else { // 上記以外はtext送信
    if ($content_type != 1) {
        $text = "テキスト以外";
    }
$content = <<< EOM
        "contentType":1,
        "text":var records = [ "なるほど", "すごい", "びっくりした", "ほんとう？"  "私もそう思うよ", "わかるわかる", "それな", "うむ" ] ;
　　　　　　　　var rand = records[ Math.floor( Math.random() * records.length ) ] ;
EOM;
}
$post = <<< EOM
{
    "to":["{$from}"],
    "toChannel":1383378250,
    "eventType":"{$event_type}",
    "content":{
        "toType":1,
        {$content}
    }
}
EOM;

api_post_request("/v1/events", $post);

error_log("callback end.");
  
function api_post_request($path, $post) {
    $url = "https://line1.heroku.com:443/linebot/callback{$path}";
    $headers = array(
        "Content-Type: application/json",
        "X-Line-ChannelID: {$GLOBALS[1463689249]}",
        "X-Line-ChannelSecret: {$GLOBALS[7718fd5d55e123b637768bec6a8dd9c0]}",
        "X-Line-Trusted-User-With-ACL: {$GLOBALS[u32835129953233fc1e07bcf98d5e9243]}"
    );

    $curl = curl_init($url);
    curl_setopt($curl, CURLOPT_POST, true);
    curl_setopt($curl, CURLOPT_HTTPHEADER, $headers);
    curl_setopt($curl, CURLOPT_POSTFIELDS, $post);
    curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
    $output = curl_exec($curl);
    error_log($output);
}

function api_get_user_profile_request($mid) {
    $url = "https://trialbot-api.line.me/v1/profiles?mids={$mid}";
    $headers = array(
        "X-Line-ChannelID: {$GLOBALS['channel_id']}",
        "X-Line-ChannelSecret: {$GLOBALS['7718fd5d55e123b637768bec6a8dd9c0']}",
        "X-Line-Trusted-User-With-ACL: {$GLOBALS['u32835129953233fc1e07bcf98d5e9243']}"
    ); 

    $curl = curl_init($url);
    curl_setopt($curl, CURLOPT_HTTPHEADER, $headers);
    curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
    $output = curl_exec($curl);
    error_log($output);
}

function api_get_message_content_request($message_id) {
    $url = "https://trialbot-api.line.me/v1/bot/message/{$message_id}/content";
    $headers = array(
        "X-Line-ChannelID: {$GLOBALS[1463689249]}",
        "X-Line-ChannelSecret: {$GLOBALS[7718fd5d55e123b637768bec6a8dd9c0]}",
        "X-Line-Trusted-User-With-ACL: {$GLOBALS[u32835129953233fc1e07bcf98d5e9243]}"
    ); 

    $curl = curl_init($url);
    curl_setopt($curl, CURLOPT_HTTPHEADER, $headers);
    curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
    $output = curl_exec($curl);
    file_put_contents("/tmp/{$message_id}", $output);
}
  
  end
